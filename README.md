# Тема ВКР: Применение методов глубокого обучения для рейтинговой оценки и классификации изображений на основе правил композиции
Выполнил:\
Горинов Даниил Андреевич (338960),\
студент группы P34151.

Данный репозиторий содержит исходный код, модели и веб-интерфейс для дипломной работы, посвящённой автоматической оценке изображений по формализованным правилам композиции. Работа объединяет методы глубокого обучения, интерпретируемости ИИ и пользовательский интерфейс.

## Описание

Веб-приложение предназначено для анализа композиции изображений на основе 13 формализованных признаков: "центр", "правило третей", "диагональ", "симметрия", "золотое сечение" и др.

Реализованы:
- Мультизадачные нейросетевые модели (ResNet-50, EfficientNet-B3, ViT-B/16, CLIP, Ансамблирование),
- Гибридный подход с SVM на эмбеддингах ViT,
- Интерпретация моделей через Grad-CAM и SHAP,
- Система автоматического сравнения моделей,
- Веб-интерфейс с REST API.

## Структура

```
CoRE_Project/
├── CoRE_Dataset/         # Датасет (метки и пути к изображениям)
│   ├── images/           # Изображения датасета, следует загрузить отдельно
│   ├── unified_dataset.csv
│   └── unified_dataset.txt
│
├── web-app/              # Веб-интерфейс (React + FastAPI)
│   ├── image-composition-ui/  # Фронтенд (React + MUI)
│   │   └── src/components/    # Компоненты: Upload, Results, Interpretation, Export
│   ├── models/                # Обученные модели (ViT, EfficientNet, ResNet, SVM)
│   ├── results/               # CSV и графики
│   ├── uploads/               # Загруженные и интерпретированные изображения
│   ├── db.sqlite3             # Локальная БД изображений
│   ├── main.py                # FastAPI сервер
│   └── my_model.py            # Визуализация Grad-CAM / SHAP
│
├── models/              # Обученные модели, следует загрузить отдельно
│
├── image_counter.py     # Подсчёт изображений по классам
├── model_analysis.ipynb # Блокнот: обучение и сравнение моделей
```

## Запуск

### Backend (FastAPI):
```bash
cd web-app
python main.py
```

### Frontend (React + Vite):
```bash
cd web-app/image-composition-ui
npm install
npm run dev
```

### Открыть в браузере:
```
http://localhost:5173
```

## Основные компоненты

- `main.py`: сервер FastAPI с маршрутами для загрузки, анализа и визуализации.
- `my_model.py`: функции Grad-CAM / SHAP для интерпретации.
- `model_analysis.ipynb`: обучение моделей, ансамблирование, выбор лучшей.
- `image_counter.py`: анализ распределения классов в датасете.

## Особенности

- **Мультизадачное обучение** (регрессия + классификация).
- **Автоматический выбор лучшей модели** (по MAE, Accuracy, Latency).
- **Интерпретируемость**: Grad-CAM и SHAP.
- **Веб-интерфейс**: загрузка изображений, визуализация, экспорт результатов.

## Метрики

- MAE (средняя абсолютная ошибка)
- Accuracy (доля правильных классификаций)
- Latency (мс/изображение)
- Сводный рейтинг (total_score)

## Зависимости

- Python: torch, torchvision, timm, pytorch-lightning, scikit-learn, shap, matplotlib, fastapi, sqlalchemy
- Node.js: React, MUI, axios, vite

## Данные

Изображения доступны по [ссылке](https://drive.google.com/drive/folders/15MMHcjJzhz1uHRRJgf05vPD4ZM5i1Vii?usp=sharing)\
Обученные модели доступны по [ссылке](https://drive.google.com/drive/folders/1UW7aF9RBmEQCFEkt0yUwP56WKVXhyHfX?usp=sharing)

Автор: Горинов Даниил Андреевич, ИТМО, 2025